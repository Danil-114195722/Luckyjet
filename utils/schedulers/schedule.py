import asyncio
from datetime import datetime, timedelta
from random import choice

from aiogram.dispatcher import Dispatcher
from aiogram import Bot

from data.config import TOKEN
from utils.db_connection import select_all_users, del_rate
from utils.keyboard import inline_join_group, inline_buy_rate
from data.constants import free_time, month_time, \
    push_not_reg_30min, push_not_reg_12hours, push_not_reg_4hours, push_not_reg_1day, push_not_reg_3days, \
    push_not_pay_1hour, push_not_pay_3hours, push_not_pay_12hours, push_not_pay_1day


bot = Bot(token=TOKEN)
disp = Dispatcher(bot=bot)


async def scheduler():
    all_users = select_all_users()
    for user in all_users:
        now_datetime = datetime.now() - timedelta(hours=3)
        user_id = user[1]

        if user[3] is not None and user[3] != 2:
            rate_date = datetime.strptime(user[-2], '%Y-%m-%d %H:%M:%S')

            if user[3] == 1:
                if now_datetime - rate_date >= month_time:
                    # ĞĞĞĞ£Ğ›Ğ˜Ğ Ğ£Ğ•Ğœ ĞĞŸĞ›ĞĞ¢Ğ£
                    del_rate(tg_id=user_id)

            elif user[3] == 0:
                if now_datetime - rate_date >= free_time:
                    # ĞĞĞĞ£Ğ›Ğ˜Ğ Ğ£Ğ•Ğœ ĞĞŸĞ›ĞĞ¢Ğ£
                    del_rate(tg_id=user_id)

        if not user[2]:
            # print('yo2')
            start_date = datetime.strptime(user[-1], '%Y-%m-%d %H:%M:%S')
            # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ ĞŸĞ£Ğ¨Ğ˜ Ğ‘Ğ•Ğ— Ğ Ğ•Ğ“Ğ˜Ğ¡Ğ¢Ğ ĞĞ¦Ğ˜Ğ˜

            if ((now_datetime - start_date) > (push_not_reg_3days - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_reg_3days):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£

                random_choice = choice([0, 1])
                if random_choice == 0:
                    text = '''â—ï¸Ğ”Ñ€ÑƒĞ¶Ğ¸Ñ‰Ğµ, Ñ‚Ñ‹ Ğ±Ñ‹ Ğ¼Ğ¾Ğ³ ÑƒĞ¶Ğµ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ ğŸ’°, Ğ½Ğ¾ Ğ´Ğ¾ ÑĞ¸Ñ… Ğ¿Ğ¾Ñ€ Ğ½Ğµ Ğ¿Ñ€Ğ¾ÑˆÑ‘Ğ» Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ!
ğŸ”¥Ğ¡ĞºĞ¾Ñ€ĞµĞµ Ğ¶Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ ĞĞĞ§ĞĞ¢Ğ¬ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸! Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞ¹ÑÑ Ğ¸ ÑƒĞ¶Ğµ Ñ‡ĞµÑ€ĞµĞ· 30 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ÑˆÑŒ ÑĞ²Ğ¾Ğ¹ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ» âœ…, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ ÑƒĞ¼Ğ½Ğ¾Ğ¶Ğ¸Ñ‚ Ñ‚Ğ²Ğ¾Ğ¸ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ ğŸ¤‘'''
                else:
                    text = '''â—ï¸Ğ£Ğ¶Ğµ Ñ‡ĞµÑ€ĞµĞ· 30 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ´Ğ°Ğ¼ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ» âœ… Ğ² ÑĞ²Ğ¾ĞµĞ¹ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¾Ğ¹ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğµ! ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ĞµĞ³Ğ¾ Ğ¼Ğ¾Ğ¶ĞµÑ‚ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¸Ğ· Ğ²Ğ°Ñ ğŸ˜ ĞĞ°Ğ´Ğ¾ Ğ²ÑĞµĞ³Ğ¾ Ğ»Ğ¸ÑˆÑŒ:
1ï¸âƒ£ ĞĞ°Ğ¶Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ ĞĞĞ§ĞĞ¢Ğ¬ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸
2ï¸âƒ£ ĞŸÑ€Ğ¾Ğ¹Ñ‚Ğ¸ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ ğŸ˜‰
3ï¸âƒ£ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ² Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚ÑƒÑ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñƒ ğŸ˜
4ï¸âƒ£ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ ÑĞ¸Ğ³Ğ½Ğ°Ğ» ÑƒĞ¶Ğµ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ âœ…'''
                await bot.send_message(
                    chat_id=user_id,
                    text=text,
                    reply_markup=inline_join_group
                )
                continue

            elif ((now_datetime - start_date) > (push_not_reg_1day - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_reg_1day):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£
                await bot.send_message(
                    chat_id=user_id,
                    text='''Ğ•Ñ‰Ğµ Ñ€Ğ°Ğ· Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚! Ğ¢Ñ‹ ÑƒĞ¶Ğµ Ğ½Ğ°Ğ´ÑƒĞ¼Ğ°Ğ» Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ñ Ğ¶Ğ¸Ğ·Ğ½ÑŒ Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ?
Ğ¢Ñ‹ ÑƒĞ¶Ğµ Ğ´Ğ¾Ğ»Ğ³Ğ¾ Ğ´ÑƒĞ¼Ğ°ĞµÑˆÑŒ Ğ¸ Ğ·Ğ° ÑÑ‚Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ¼Ğ¾Ğ³ Ğ±Ñ‹ ÑƒĞ¶Ğµ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ½Ğ° Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğ¹ Ğ¾Ñ‚Ğ´Ñ‹Ñ… Ğ½Ğ° Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ñ ÑĞµĞ¼ÑŒĞµĞ¹!
Ğ¢ĞµĞ±Ğµ Ğ½Ğµ ĞºĞ°Ğ¶ĞµÑ‚ÑÑ, Ñ‡Ñ‚Ğ¾ Ğ¿Ğ¾Ñ€Ğ° Ğ¼ĞµĞ½ÑÑ‚ÑŒ ÑĞ²Ğ¾Ñ Ğ¶Ğ¸Ğ·Ğ½ÑŒ?
ĞĞ°Ğ¶Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ ĞĞĞ§ĞĞ¢Ğ¬ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸!''',
                    reply_markup=inline_join_group
                )
                continue

            elif ((now_datetime - start_date) > (push_not_reg_12hours - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_reg_12hours):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£
                await bot.send_message(
                    chat_id=user_id,
                    text='''Ğ¢Ñ‹ Ğ´ÑƒĞ¼Ğ°ĞµÑˆÑŒ ÑƒĞ¶Ğµ Ñ†ĞµĞ»Ñ‹Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ!
ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚ÑĞ³Ğ° Ğ·Ğ° 12 Ñ‡Ğ°ÑĞ¾Ğ² (Ñ€Ğ°Ğ±Ğ¾Ñ‡ÑƒÑ ÑĞ¼ĞµĞ½Ñƒ) Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ 1.500 Ñ€ÑƒĞ±Ğ»ĞµĞ¹ Ğ¸ Ğ²ĞµÑ‡ĞµÑ€Ğ¾Ğ¼ Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ğ² ĞºÑ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ±ĞµĞ· ÑĞ¸Ğ», Ğ° Ñ‚Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑˆÑŒ Ğ½Ğµ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ñ Ğ¸Ğ· Ğ´Ğ¾Ğ¼Ğ° Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ñ‚ 10.000 Ğ² Ğ´ĞµĞ½ÑŒ Ğ¸ ĞºĞ°Ğ¹Ñ„Ğ¾Ğ²Ğ°Ñ‚ÑŒ!
Ğ¢Ñ‹ Ñ…Ğ¾Ñ‡ĞµÑˆÑŒ Ñ‚Ğ°Ğº Ğ¶Ğ¸Ñ‚ÑŒ?
ĞĞ°Ğ¶Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ ĞĞĞ§ĞĞ¢Ğ¬ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸!''',
                    reply_markup=inline_join_group
                )
                continue

            elif ((now_datetime - start_date) > (push_not_reg_4hours - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_reg_4hours):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£
                await bot.send_message(
                    chat_id=user_id,
                    text='''ĞŸĞ¾ĞºĞ° Ñ‚Ñ‹ Ğ´ÑƒĞ¼Ğ°ĞµÑˆÑŒ Ğ¼Ğ½Ğ¾Ğ³Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ¸ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¸ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ!
Ğ—Ğ° 3 Ñ‡Ğ°ÑĞ° Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ¿Ğ¾ĞºĞ¾Ğ¹Ğ½Ğ¾ ÑƒĞ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¹ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ² 2-3 Ñ€Ğ°Ğ·Ğ°!
Ğ¢Ñ‹ Ñ…Ğ¾Ñ‡ĞµÑˆÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ÑƒĞ¶Ğµ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ?
ĞĞ°Ğ¶Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ ĞĞĞ§ĞĞ¢Ğ¬ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸!''',
                    reply_markup=inline_join_group
                )
                continue

            elif ((now_datetime - start_date) > (push_not_reg_30min - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_reg_30min):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£
                await bot.send_message(
                    chat_id=user_id,
                    text='''Ğ”Ñ€ÑƒĞ³, Ñ‚ĞµĞ±Ğµ Ğ½Ğ°Ğ´Ğ¾ Ğ²ÑĞµ Ğ»Ğ¸ÑˆÑŒ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ!
Ğ­Ñ‚Ğ¾ Ğ·Ğ°Ğ¹Ğ¼ĞµÑ‚ Ñƒ Ñ‚ĞµĞ±Ñ Ğ¿Ğ°Ñ€Ñƒ Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ¸ Ñ‚Ñ‹ ÑĞ¼Ğ¾Ğ¶ĞµÑˆÑŒ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ ÑƒĞ¶Ğµ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ!
ĞĞ°Ğ¶Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ ĞĞĞ§ĞĞ¢Ğ¬ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸!''',
                    reply_markup=inline_join_group
                )
                continue
            else:
                continue

        if user[2] and user[3] is None:
            # print('yo1')
            start_date = datetime.strptime(user[-3], '%Y-%m-%d %H:%M:%S')
            # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ ĞŸĞ£Ğ¨Ğ˜ Ğ‘Ğ•Ğ— ĞĞŸĞ›ĞĞ¢Ğ« Ğ”Ğ•ĞŸĞĞ—Ğ˜Ğ¢Ğ

            if ((now_datetime - start_date) > (push_not_pay_1day - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_pay_1day):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£

                random_choice = choice([0, 1, 2])
                if random_choice == 0:
                    text = '''ĞšĞ¾Ğ³Ğ´Ğ° Ñ‚Ñ‹ Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ? ĞœĞ½Ğµ Ğ²Ğ°Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ñ‚ĞµĞ±Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚, Ğ²ĞµĞ´ÑŒ Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ Ğ½Ğ°Ğ´ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ ÑĞ²Ğ¾ĞµĞ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¸ Ğ¼Ğ½Ğµ Ğ²Ğ°Ğ¶ĞµĞ½ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞº!
\nĞ¢Ñ‹ Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ?
Ğ¢ĞµĞ±Ğµ Ğ¾ÑÑ‚Ğ°Ğ»ÑÑ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ ÑˆĞ°Ğ³, Ğ²ÑĞµĞ³Ğ¾ Ğ»Ğ¸ÑˆÑŒ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ¸Ñ‚ÑŒ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ¸ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ!
Ğ¯ Ğ´Ğ»Ñ Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ñ‚ĞµĞ±Ğµ Ğ²ÑĞµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹!'''
                elif random_choice == 1:
                    text = '''Ğ¡ĞºĞ¾Ñ€Ğ¾ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾ Ğ¸Ğ³Ñ€Ñ‹ Ğ¿Ğ¾ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°Ğ¼ Ğ² Ğ¼Ğ¾ĞµĞ¹ Ğ’Ğ˜ĞŸ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğµ!
Ğ¢Ñ‹ Ñ…Ğ¾Ñ‡ĞµÑˆÑŒ ÑƒĞ¶Ğµ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¸ Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ Ğ² Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½Ğµ Ğ½Ğµ Ğ²ÑÑ‚Ğ°Ğ²Ğ°Ñ Ñ Ğ´Ğ¸Ğ²Ğ°Ğ½Ğ°?
Ğ¯ Ğ¶Ğ´Ñƒ Ñ‚ĞµĞ±Ñ, Ñ‚ĞµĞ±Ğµ Ğ¾ÑÑ‚Ğ°Ğ»ÑÑ Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ğ¹ ÑˆĞ°Ğ³, Ğ´Ğ»Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ½Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ÑĞ¾ Ğ¼Ğ½Ğ¾Ğ¹!'''
                else:
                    text = '''Ğ—Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ Ğ² ÑÑ€ĞµĞ´Ğ½ĞµĞ¼ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¹ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸Ğº Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ +400% Ğº ÑĞ²Ğ¾ĞµĞ¼Ñƒ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ñƒ!
ĞŸÑ€ĞµĞ´ÑÑ‚Ğ°Ğ²ÑŒ ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ñ‚Ñ‹ Ğ±Ñ‹ ÑĞ¼Ğ¾Ğ³ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğµ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ñ Ğ¸Ñ… Ğ´Ğ¾Ğ¼Ğ°? Ğ­Ñ‚Ğ¾ Ñ„Ğ°Ğ½Ñ‚Ğ°ÑÑ‚Ğ¸ĞºĞ°!
Ğ¢ĞµĞ±Ğµ Ğ¾ÑÑ‚Ğ°Ğ»ÑÑ Ğ²ÑĞµĞ³Ğ¾ Ğ¾Ğ´Ğ¸Ğ½ ÑˆĞ°Ğ³ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ Ñ„Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ğ¾Ğ¹ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ñ‹!
ĞĞ°Ğ¶Ğ¸Ğ¼Ğ°Ğ¹ Ğ½Ğ° ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ Ğ¸ Ğ´Ğ°Ğ²Ğ°Ğ¹ Ğ½Ğ°Ñ‡Ğ½ĞµĞ¼!'''

                await bot.send_message(
                    chat_id=user_id,
                    text=text,
                    reply_markup=inline_buy_rate
                )
                continue

            elif ((now_datetime - start_date) > (push_not_pay_12hours - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_pay_12hours):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£
                await bot.send_message(
                    chat_id=user_id,
                    text='''Ğ—Ğ° Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ğ´ĞµĞ½ÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‚ÑĞ³Ğ° Ğ½Ğ° Ğ¾Ñ„Ğ¸ÑĞ½Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ 1.500 Ñ€ÑƒĞ±Ğ»ĞµĞ¹, Ğ° Ñ‚Ñ‹ Ğ¼Ğ¾Ğ³ Ğ±Ñ‹ ÑƒĞ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ğ¹ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ² 2-3 Ñ€Ğ°Ğ·Ğ° Ğ½Ğµ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ñ Ğ¸Ğ· Ğ´Ğ¾Ğ¼Ğ°!
Ğ­Ñ‚Ğ¾ Ğ¿Ñ€ĞµĞºÑ€Ğ°ÑĞ½Ğ°Ñ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¶Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¶Ğ¸Ğ·Ğ½ÑŒÑ!
Ğ¢Ñ‹ Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ñ Ğ¶Ğ¸Ğ·Ğ½ÑŒ?
ĞĞ¿Ğ»Ğ°Ñ‡Ğ¸Ğ²Ğ°Ğ¹ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ¸ Ñ Ñ‚ĞµĞ±Ğµ Ğ´Ğ°Ğ¼ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ² Ğ—ĞĞšĞ Ğ«Ğ¢Ğ«Ğ™ Ğ’Ğ˜ĞŸ ĞšĞĞĞĞ›
Ğ–Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ!''',
                    reply_markup=inline_buy_rate
                )
                continue

            elif ((now_datetime - start_date) > (push_not_pay_3hours - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_pay_3hours):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£
                await bot.send_message(
                    chat_id=user_id,
                    text='''Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ° Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ½Ğ°Ñ Ğ¸Ğ³Ñ€Ğ° Ğ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ñ„ĞµĞ½Ğ¾Ğ¼ĞµĞ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ, Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ ĞºĞ°Ñ„Ñ‹ Ğ¸ Ğ¾Ñ‡ĞµĞ½ÑŒ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ñ‹ Ğ½Ğ° ÑÑ‚Ğ°Ğ²ĞºĞ¸!
Ğ•ÑĞ»Ğ¸ Ğ¸Ğ³Ñ€Ğ°Ñ‚ÑŒ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ¾. Ğ¿Ğ¾ Ğ¼Ğ¾ĞµĞ¹ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ¸ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ°Ğ¼, Ñ‚Ğ¾ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ñ‚ 40% Ğº ÑĞ²Ğ¾ĞµĞ¼Ñƒ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ñƒ Ğ±ĞµĞ· Ğ½ĞµÑ€Ğ²Ğ¾Ğ²!
Ğ¢Ñ‹ Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ? Ğ¢Ğ¾Ğ³Ğ´Ğ° Ğ¾Ğ¿Ğ»Ğ°Ñ‡Ğ¸Ğ²Ğ°Ğ¹ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ (Ğ½Ğ°Ğ¶Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ), Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ² Ğ’Ğ˜ĞŸ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñƒ Ğ¸ Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°Ğ¹ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ!''',
                    reply_markup=inline_buy_rate
                )
                continue

            elif ((now_datetime - start_date) > (push_not_pay_1hour - timedelta(minutes=1))) and \
                    ((now_datetime - start_date) <= push_not_pay_1hour):
                # ĞŸĞĞ¡Ğ«Ğ›ĞĞ•Ğœ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• Ğ®Ğ—Ğ•Ğ Ğ£
                await bot.send_message(
                    chat_id=user_id,
                    text='''ĞŸÑ€Ğ¸ÑÑ‚ĞµĞ»ÑŒ, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ° Ğ¸Ğ³Ñ€Ğ° Ğ² Ğ¼Ğ¾ĞµĞ¼ Ğ’Ğ˜ĞŸ ĞºĞ°Ğ½Ğ°Ğ»Ğµ Ğ¸ Ğ² ÑÑ€ĞµĞ´Ğ½ĞµĞ¼ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸Ğº Ğ’Ğ˜ĞŸ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñƒ ÑƒĞ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ğ» ÑĞ²Ğ¾Ğ¹ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ² 2 Ñ€Ğ°Ğ·Ğ°!
ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ñ‚Ñ‹ Ğ²ÑĞµ ĞµÑ‰Ğµ Ğ½Ğµ Ğ¿Ñ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½Ğ¸Ğ»ÑÑ Ğº Ğ½Ğ°Ğ¼?
ĞĞ¿Ğ»Ğ°Ñ‡Ğ¸Ğ²Ğ°Ğ¹ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ¸ Ñ Ñ‚ĞµĞ±Ğµ Ğ´Ğ°Ğ¼ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ² Ğ—ĞĞšĞ Ğ«Ğ¢Ğ«Ğ™ Ğ’Ğ˜ĞŸ ĞšĞĞĞĞ›
Ğ–Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ!''',
                    reply_markup=inline_buy_rate
                )
                continue

    await bot.close()


async def main():
    while True:
        await scheduler()
        await asyncio.sleep(60)


if __name__ == '__main__':
    asyncio.run(main())
